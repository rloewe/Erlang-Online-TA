\section{Implementation}
\subsection{Master server}
To start the master server, the start function takes a filepath to the config file with specifications, that can be seen ~\ref{sec:config}. It is also required that the there is a default.conf file in the directory where the master server is started from. Upon startup it loads the values of the config files and sets the cookie specified. It creates 3 directories "/Handins/", "Assignments/" and "/Modules/" that are used to store files uploaded to the server and creates a new process alongside the master server to monitor connecting and disconnecting nodes. The master state is a record type that consists of:
\begin{itemize}
\item nodes : is a dictionary of nodes as keys and the value is the list of sessiontokens of handin jobs running the node.
\item sessions : is a dictionary of Sessiontokens as keys and a tuple of \{Assignment ID, Status of the handin job, Name of the directory under /Handins/ the handin files are located\}
\item assignments : is a dictionary of AssignmentID as keys and a dictionary containing the parsed assignment config information.
\item modules : is a dictionary where the key is the name of the module as an atom and the value is the filename of the module located under /Modules/
\item queue : is a queue containing handin jobs if a node crashes and no other is available
\item userSockets : a list of connected sockets from the webserver
\end{itemize}

If a node connects to the master, the master server spawns a process to send all current modules and assignments that have been added to the master server since startup. When Adding modules to the system, the master server saves the given binary of the modules beam file in the /Modules/ directory with the given module name, and updates the modules dictionary in the master state. When adding an assignment, the assignment configuartion file is checked if it is valid based on the specifications of ~/ref{sec:assignment}, if validated a folder with the assignment id is created under /Assignments/ where the required files are saved. When adding either modules or assignments the server will spawn a process that distributes the new module or assignment to all connected nodes to keep the server responsive.

Handin jobs are handled by checking if the given assignment ID is valid, if the assignment id is valid a sessiontoken is created by using makeref. The server spawns a process to save the files locally in a unqiue directory in /Handins/ and send the files, session token and assignment id to a node server to queue a handin job. The master responds to the sender with the session token and a status stating the handin is receieved. Handin jobs are updated when the node server sends an asynchronous messages to the master with the update, it informs the user with the given session token with the status update and the result if the job is finished. If a job is finished, the master server deletes the handin files from the unique directory in /Handins/.

The distribution over nodes is done at random, this should generate an even distribution of handin jobs over the nodes. Altho this does not ensure equal load on the node servers as it does not distinguish between general workload of the jobs. If a node dies with running jobs, the monitor gets notified and makes a asynchronous message to the master. The master then redistributes the jobs over the remaining nodes, if no nodes are available the jobs are put into queue and restarted when a new node connects.

\subsection{Specifications of files}
\subsubsection{Configfile}
\label{sec:config}
The config file seperates each parameter by a newline, where each parameter is specified as param = value.
The list below specifies the requires parameters, the parameter names are case sensitive.
\begin{itemize}
    \item Cookie : Required by both master and node, is the name of the cookie the server and nodes run on.
    \item Master : Required in the node server only, the value is name@hostname, name is the name of the master server specified upon startup of the master, and hostname is the hostname the master server runs under.
\end{itemize}
\subsubsection{AssignmentConfigFile}
\label{sec:assignment}
The assignment config files seperates each parameter by a newline, where each parameter is specified as param = value. If multiple values are required they are comma seperated, but still on one line. A default variable name called "defaults.conf" is required, containing the not required fields.
The list below specifies the requires parameters, the parameter names are case insensitive.
\begin{itemize}
    \item assignmentid : Required field, value is the name of the assignment.
    \item module : Required field, name is the module the assignment wants to use, requires the module to be uploaded to the server.
    \item runorder : Required field, comma seperated values, the values is the filename of the scripts to be run in the given order.
    \item required\_libs : Required field, commma seperated values, the name of the libaries the assignment needs to run a handin. If no libs are required the value must be required\_libs =
    \item disk : Not required field, must be either the value enabled or disabled. If this field is not present it is set to default value.
    \item network : Not required field, must be either the value enabled or disabled. If this field is not present it is set to default value.
    \item maxmem : Not required field, must be a integer value. If this field is not present it is set to default value.
    \item maxtime : Not required field, must be a integer value. If this field is not present it is set to default value.
\end{itemize}







